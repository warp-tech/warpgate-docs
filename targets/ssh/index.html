<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>SSH - Warpgate</title>
  <link rel="icon" type="image/svg" href="/assets/favicon-B-qGPERB.svg">

  <script>
    window.base_url = '/' // for search
  </script>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-55PX9VYM8V"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-55PX9VYM8V');
  </script>
  <script type="module" crossorigin src="/assets/app-DEsyNBvb.js"></script>
  <link rel="stylesheet" crossorigin href="/assets/app-CKRbU5ud.css">
</head>

<body>
  <header class="container">
    <a href="/">
      <img class="logo" src="/assets/brand-dark-BgjQA_wK.svg" />
    </a>

    
      <form action="search.html" class="search-form">
        <input class="form-control" name="q" id="mkdocs-search-query" type="text" placeholder="Search docs..." />
      </form>
    

    

    <!-- <a class="btn btn-success" href="https://github.com/warp-tech/warpgate/releases" target="_blank">Downloads</a> -->
    <a class="btn btn-primary" href="https://github.com/warp-tech/warpgate" target="_blank">GitHub</a>
  </header>

  <div id="mkdocs-search-results" class="container search-results"></div>

  <div class="layout container">
    
    <div class="nav">
      <h3>Docs</h3>
      <ul>
        
        
        <li>
          <a class="" href="../../docs/">Home</a>
        </li>
        
        
        
        <li>Getting started
          <ul>
            
            <li>
              <a class="" href="../../getting-started/">Native</a>
            </li>
            
            <li>
              <a class="" href="../../getting-started-on-docker/">Docker</a>
            </li>
            
          </ul>
        </li>
        
        
        
        <li>Adding targets
          <ul>
            
            <li>
              <a class="text-success" href="./">SSH</a>
            </li>
            
            <li>
              <a class="" href="../http/">HTTP</a>
            </li>
            
            <li>
              <a class="" href="../mysql/">MySQL</a>
            </li>
            
            <li>
              <a class="" href="../postgres/">PostgreSQL</a>
            </li>
            
          </ul>
        </li>
        
        
        
        <li>Access control
          <ul>
            
            <li>
              <a class="" href="../../auth-and-roles/">User authentication and roles</a>
            </li>
            
            <li>
              <a class="" href="../../tickets/">Access tickets</a>
            </li>
            
            <li>
              <a class="" href="../../otp/">One-time passwords (OTP)</a>
            </li>
            
            <li>
              <a class="" href="../../sso/">Single sign-on</a>
            </li>
            
            <li>
              <a class="" href="../../recovering-access/">Recovering admin access</a>
            </li>
            
          </ul>
        </li>
        
        
        
        <li>Ops
          <ul>
            
            <li>
              <a class="" href="../../systemd/">Installing as a systemd service</a>
            </li>
            
            <li>
              <a class="" href="../../log-forwarding/">Log forwarding</a>
            </li>
            
            <li>
              <a class="" href="../../reverse-proxy/">Running behind a reverse proxy</a>
            </li>
            
          </ul>
        </li>
        
        
        
        <li>Advanced topics
          <ul>
            
            <li>
              <a class="" href="../../http-domain-binding/">HTTP domain binding</a>
            </li>
            
            <li>
              <a class="" href="../../chaining/">Chaining Warpgates</a>
            </li>
            
            <li>
              <a class="" href="../../protocol-support/">Protocol support</a>
            </li>
            
          </ul>
        </li>
        
        
      </ul>
    </div>
    

    <div class="page-content">
      <article>
        <h1 id="adding-ssh-targets">Adding SSH targets<a class="headerlink" href="#adding-ssh-targets" title="Permanent link">§</a></h1>
<h2 id="authentication-setup">Authentication setup<a class="headerlink" href="#authentication-setup" title="Permanent link">§</a></h2>
<h3 id="preferred-public-key-auth">Preferred: public-key auth<a class="headerlink" href="#preferred-public-key-auth" title="Permanent link">§</a></h3>
<p>Warpgate has its own set of SSH keys which the target host must trust in order for connections to work.</p>
<p>You can view these keys on the <code>Config</code> -&gt; <code>SSH keys</code> page of the Admin UI, or via the <code>warpgate client-keys</code> CLI command:</p>
<figure>
<p><img alt="" src="../../images/ssh-keys.png" /></p>
<figcaption>
<p>Warpgate's public keys</p>
</figcaption>
</figure>
<div class="language-text highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code>$ warpgate client-keys
13:59:41  INFO Using config: &quot;/etc/warpgate.yaml&quot; (users: 1, targets: 2, roles: 1)
Warpgate SSH client keys:
(add these to your target&#39;s authorized_keys file)

ssh-ed25519 AAAAC3NzaC1lZDI1NTE[...]aM+3RBsT5
rsa-sha2-256 AAAADHJzYS[...]
</code></pre></div>
<p>The keys are listed in the order of preference. Copy one of them and paste it at the end of the <code>~/.ssh/authorized_keys</code> file on the other side (each target host OS' user has their own <code>authorized_keys</code> file and you will need to create it if it doesn't exist yet).</p>
<h3 id="alternative-password-authentication">Alternative: password authentication<a class="headerlink" href="#alternative-password-authentication" title="Permanent link">§</a></h3>
<p>Although not recommended, you can use a password to authenticate against a target instead.</p>
<h2 id="connection-setup">Connection setup<a class="headerlink" href="#connection-setup" title="Permanent link">§</a></h2>
<p>Log into the Warpgate admin UI and navigate to <code>Config</code> &gt; <code>Targets</code> &gt; <code>Add target</code> and give the new target a name:</p>
<figure>
<p><img alt="" src="../../images/adding-ssh.png" /></p>
<figcaption>
<p>Adding an SSH target</p>
</figcaption>
</figure>
<p>Fill out the connection and authentication info and click <code>Update configuration</code>, for example:</p>
<figure>
<p><img alt="" src="../../images/ssh-config.png" /></p>
<figcaption>
<p>SSH target configuration</p>
</figcaption>
</figure>
<p>The target should show up on the Warpgate homepage for users that are allowed to access it:</p>
<figure>
<p><img alt="" src="../../images/ssh-on-home.png" /></p>
<figcaption>
<p>SSH target on the start page</p>
</figcaption>
</figure>
<p>Users will be able to click the entry to obtain connection instructions:</p>
<figure>
<p><img alt="" src="../../images/ssh-instructions.png" /></p>
<figcaption>
<p>SSH connection instructions</p>
</figcaption>
</figure>
<h2 id="client-setup">Client setup<a class="headerlink" href="#client-setup" title="Permanent link">§</a></h2>
<p>Now, fire up your favorite SSH client and try connecting to Warpgate:</p>
<ul>
<li>Host: the Warpgate host</li>
<li>Port: the Warpgate SSH port (default: 2222)</li>
<li>Username: <code>admin:&lt;target-name&gt;</code>, in this example: <code>admin:vm1</code></li>
<li>Password: your Warpgate admin password</li>
</ul>
<p>When connecting for the first time, Warpgate will ask you to check and confirm the target host's SSH host key fingerprint (which you really should do).</p>
<p>Here's what it looks like with OpenSSH:</p>
<div class="language-text highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code>$ ssh admin:vm1@192.168.77.253 -p 2222
admin:vm1@192.168.77.253&#39;s password:

 Warpgate  Selected target: vm1
 Warpgate  Host key (ssh-ed25519): AAAAC3[...]
 Warpgate  There is no trusted ssh-ed25519 key for this host.
 Warpgate  Trust this key? (y/n)

 ✓ Warpgate connected

 root ~   $
</code></pre></div>
<p>From this point on, you can use this as a normal SSH connection, including SFTP etc.</p>
<p>While your SSH session is running, you'll be able to see its status in the Admin UI:</p>
<figure>
<p><img alt="" src="../../images/ssh-log.png" /></p>
<figcaption>
<p>SSH session log</p>
</figcaption>
</figure>
<p>Click the shell session entry in the <code>Recordings</code> section for a live view and replay of the terminal session:</p>
<figure>
<p><img alt="" src="../../images/ssh-recording.png" /></p>
<figcaption>
<p>SSH session recording</p>
</figcaption>
</figure>
<h3 id="up-next">Up next<a class="headerlink" href="#up-next" title="Permanent link">§</a></h3>
<ul>
<li><a href="../../auth-and-roles/">User authentication and roles</a></li>
</ul>
      </article>

      <div class="d-flex">
        
          <a class="btn btn-secondary btn-prev" href="../../getting-started-on-docker/">
            &larr;
            Docker
            <br/>
            <small class="text-muted">
              Previous
            </small>
          </a>
        

        <!-- Next page -->
        
          <a class="btn btn-success btn-next ms-auto" href="../http/">
            HTTP
            &rarr;
            <br/>
            <small class="text-muted">Next</small>
          </a>
        
      </div>
    </div>
  </div>
  <script src="../../search/main.js"></script>

</body>

</html>